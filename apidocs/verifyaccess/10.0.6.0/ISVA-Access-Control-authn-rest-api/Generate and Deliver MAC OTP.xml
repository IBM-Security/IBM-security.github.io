<?xml version = "1.0" encoding ="UTF-8" ?>
<?xml-stylesheet type="text/xsl" href="RAPI.xsl"?>
<application><doc>Generate and Deliver MAC OTP</doc>
<resources base="">
<resource path="https://{runtime_hostname}/mga/sps/apiauthsvc?StateId={state identifier}">
<param type="path" name="runtime_hostname">
<doc>Host name of the runtime interface the appliance listens on</doc>
</param>
<param type="query" name="StateId">
<doc>The authentication state identifier UUID</doc>
</param>
<method name="POST" id="Generate and Deliver MAC OTP"><doc>   The MAC OTP mechanisms must be correctly configured before the policy workflow can                    successfully respond to any runtime requests.  Information about its                    configuration is available under the Configuring Authentication topics                    of the IBM Knowledge Center.  </doc>
<doc>   Once the MAC OTP mechanisms has been initialized and the requests holds a valid                    state identifier for the mechanism, it is possible to generate and deliver a new                    OTP.  This is typically done following initialization of the MAC OTP where the                    initial response includes the list of valid OTP delivery methods.   </doc>
<doc>   The requester sends a POST request to the authentication service API endpoint.  The URI                    includes a dynamically generated state identifier.  The URI can be easily obtained                    from the 'location' attribute from the previous JSON response data. </doc>
<doc>   The username parameter may be specified using context attribute reference set by a mapping rule.                    Alternatively, ensure that the authentication policy requires the user to login before                     issuing a challenge with this authentication mechanism. </doc>
<request>
<doc>
 Generate and deliver a new OTP:
 
 POST https://{runtime_hostname}/mga/sps/apiauthsvc?StateId=3lmf1fS6OBDl0HI58Hf3OEdQXXe99163dIxZ8hgBXNwHGy1wdFZThAX8T0zS4x8N77f3Vq2y8ZTpzNvmcMllyLTgWWlifpP3uViVM3nmA67N9B2XBhu3rEx7w7ZnCGzW
 
 {
  "otp.user.otp-method.id": "email"
 }
 </doc><doc>The requester must maintain cookies returned by this API and send them on subsequent requests such as               PUT requests to verify credentials</doc><param name="Accept:application/json" style="header">
<doc>Required for requests to the service </doc></param>
<param name="Content-Type:application/json" style="header">
<doc>Required for requests to the service </doc></param>
<representation name="otpGenerateJsonRequest" mediatype="application/json">
<param style="plain" name="otp.user.otp-method.id" type="String" optional="No" >
<doc>The identifier of an OTP delivery method. </doc>
</param>
</representation></request>
<response status="200">
<doc>OK. The request was successful.</doc>
<doc>
 200 OK
 
 {
  "mechanism": "urn:ibm:security:authentication:asf:mechanism:macotp",
  "stateId": "PsDfpCVx1E2ifgzZ4bi1JRowqdhNsEgxsBIhK25IkTf4azYYrsAQcT4zfZa8GmdjOiOf0ZnyWMTHQuTrmlbLJg4HSCU8tMjE8kB5JRFIeViR7B4Nxg58fMSwKHzuoLJG",
  "location": "/mga/sps/apiauthsvc?StateId=PsDfpCVx1E2ifgzZ4bi1JRowqdhNsEgxsBIhK25IkTf4azYYrsAQcT4zfZa8GmdjOiOf0ZnyWMTHQuTrmlbLJg4HSCU8tMjE8kB5JRFIeViR7B4Nxg58fMSwKHzuoLJG",
  "otp.user.otp-hint": "7523",
  "otp.user.sentTo": "username@mail.com",
  "mappingRuleData": ""
 }
 
 

</doc><param name="Content-Type:application/json" style="header">
<doc>Response is in JSON formatting. </doc></param>
<representation name="macOtpGenerateJsonResponse" mediatype="application/json">
<param style="plain" name="mechanism" type="String" optional="Yes" >
<doc>The URI of current authentication mechanism which is interacting with the requester.</doc>
</param>
<param style="plain" name="state/stateId" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the authentication mechanism is available for subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="otp.user.otp-hint" type="String" optional="Yes" >
<doc>The OTP hint value sent to the user.  This value must be sent with the user supplied OTP value for verification.</doc>
</param>
<param style="plain" name="otp.user.sentTo" type="String" optional="Yes" >
<doc>The address of the device to which the OTP was delivered.</doc>
</param>
<param style="plain" name="mappingRuleData" type="String" optional="Yes" >
<doc>Any data set by the custom authentication service mapping javascript.</doc>
</param>
<param style="plain" name="location" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the URL address to send subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="message" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, Error or success message, if any.</doc>
</param>
<param style="plain" name="exceptionMsg" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates details of internally generated exception message.  May provide additional information when HTTP result status code is not success. </doc>
</param>
</representation></response><response status="400">
<doc>Bad Request. There is a problem with the request. The JSON result describes the problem.</doc>
<param name="Content-Type:application/json" style="header">
<doc>Response is in JSON formatting. </doc></param>
<representation name="initJsonResponse" mediatype="application/json">
<param style="plain" name="mechanism" type="String" optional="Yes" >
<doc>The URI of current authentication mechanism which is interacting with the requester.</doc>
</param>
<param style="plain" name="state/stateId" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the authentication mechanism is available for subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="location" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the URL address to send subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="message" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, Error or success message, if any.</doc>
</param>
<param style="plain" name="exceptionMsg" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates details of internally generated exception message.  May provide additional information when HTTP result status code is not success. </doc>
</param>
</representation></response><response status="404">
<doc>Not Found. The requested service or resource does not exist. The JSON message indicates which resource.</doc>
<param name="Content-Type:application/json" style="header">
<doc>Response is in JSON formatting. </doc></param>
<representation name="initJsonResponse" mediatype="application/json">
<param style="plain" name="mechanism" type="String" optional="Yes" >
<doc>The URI of current authentication mechanism which is interacting with the requester.</doc>
</param>
<param style="plain" name="state/stateId" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the authentication mechanism is available for subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="location" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the URL address to send subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="message" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, Error or success message, if any.</doc>
</param>
<param style="plain" name="exceptionMsg" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates details of internally generated exception message.  May provide additional information when HTTP result status code is not success. </doc>
</param>
</representation></response><response status="500">
<doc>An internal error occurred. The JSON message indicates the problem.</doc>
<param name="Content-Type:application/json" style="header">
<doc>Response is in JSON formatting. </doc></param>
<representation name="initJsonResponse" mediatype="application/json">
<param style="plain" name="mechanism" type="String" optional="Yes" >
<doc>The URI of current authentication mechanism which is interacting with the requester.</doc>
</param>
<param style="plain" name="state/stateId" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the authentication mechanism is available for subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="location" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates the URL address to send subsequent requests.  This attribute won't have a value if the HTTP status code is not a 200 family success.</doc>
</param>
<param style="plain" name="message" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, Error or success message, if any.</doc>
</param>
<param style="plain" name="exceptionMsg" type="String" optional="Yes" >
<doc>If present and length of value is greater than zero, indicates details of internally generated exception message.  May provide additional information when HTTP result status code is not success. </doc>
</param>
</representation></response></method>
</resource>
</resources>
</application>
